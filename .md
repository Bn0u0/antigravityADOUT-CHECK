這是一份為 VP2 (雲端工兵) 準備的標準實作規格書。請直接將以下內容複製或交接給 VP2 進行本地部署。

---

# 系統開發規格書：Local Antigravity 靜默授權守衛 (Windows 版)

**發布者**：VP1 (戰略大腦)
**執行者**：VP2 (雲端工兵)
**目標**：在 Windows 環境下，針對多開的 Local Antigravity 實體（綁定特定專案/檔案），實作**無頭式 (Headless) 背景靜默點擊**「確認」按鈕。
**核心要求**：

1. **零干擾**：絕對禁止使用座標模擬（如 PyAutoGUI）。必須使用 UIA (UI Automation) 底層事件觸發，不可搶奪滑鼠與鍵盤焦點。
2. **精準隔離**：在多開環境下，必須依賴「動態視窗標題」或「PID」進行唯一性鎖定，避免誤觸其他專案的執行序。

---

## 部署階段 1：特徵掃描 (X-Ray Scanner)

**目的**：提取目標 IDE 視窗在作業系統底層的精確「視窗標題」與「進程 ID (PID)」。

**VP2 執行指令**：
請先在本地端開啟所有目標 Antigravity 視窗（包含要監控與不監控的專案），然後執行以下 Python 腳本：

```python
# 依賴套件: pip install pywinauto
from pywinauto import Desktop

print("[VP2 部署] 開始掃描目前所有開啟的視窗特徵...\n")

# 抓取目前桌面上所有視窗 (UIA 架構)
windows = Desktop(backend="uia").windows()

for win in windows:
    title = win.window_text()
    # 篩選包含 Antigravity 的進程 (若軟體名稱不同，請自行替換關鍵字)
    if title and "Antigravity" in title: 
        print(f"📌 發現目標視窗：")
        print(f"   - 精確標題 (Title): {title}")
        print(f"   - 進程 PID (Process ID): {win.process_id()}")
        print("-" * 40)

```

**產出**：取得目標專案的 `精確標題 (Title)` 或 `進程 PID`，作為階段 2 的鎖定參數。

---

## 部署階段 2：背景監控守護進程 (Daemon Script)

**目的**：常駐於背景，高頻輪詢目標視窗，一旦偵測到「確認」按鈕生成，立即發送系統級 `invoke()` 點擊訊號。

**VP2 實作代碼**：
請將階段 1 取得的「精確標題」填入 `TARGET_WINDOW_TITLE`。

```python
from pywinauto.application import Application
import time

def background_strict_clicker(target_title, button_name="確認"):
    print(f"[VP2 系統] 鎖定目標視窗: {target_title}")
    
    try:
        # 1. 精確連接：利用帶有專案名稱的完整視窗標題進行綁定
        # (若要做到絕對零容錯，可將 title=target_title 改為 process=目標PID)
        app = Application(backend="uia").connect(title=target_title)
        window = app.window(title=target_title)
        
        print("[VP2 系統] 鎖定成功，背景靜默監控啟動 (頻率: 0.5s)...")
        
        while True:
            try:
                # 2. 尋找目標按鈕
                # 注意：若介面為英文，請將 button_name 預設值改為 "Confirm" 或 "OK"
                target_btn = window.child_window(title=button_name, control_type="Button")
                
                if target_btn.exists():
                    # 3. 發送底層觸發訊號，不移動實體滑鼠
                    target_btn.invoke()
                    print("✅ [攔截] 已於背景靜默觸發確認授權！")
                    
            except Exception:
                # 隱藏尋找過程中的報錯，維持乾淨的終端機輸出
                pass 
            
            time.sleep(0.5) # 緩衝休眠，防止 CPU 滿載
            
    except Exception as e:
        print(f"❌ 嚴重錯誤：無法連接至目標視窗。請確認軟體已開啟且名稱完全一致。")

# ================= 執行區 =================
# VP2 必須將此處替換為階段 1 掃描出的精確字串 (例如："專案1 - Antigravity")
TARGET_WINDOW_TITLE = "請替換為包含專案名稱的完整視窗標題" 

background_strict_clicker(TARGET_WINDOW_TITLE)

```

### ⚠️ VP2 實作注意事項 (Risk Management)

1. **權限對等原則**：如果 Local Antigravity 是以系統管理員權限啟動，此 Python 腳本**也必須以系統管理員身分 (Run as Administrator)** 執行，否則點擊訊號會被 Windows 底層 API 阻擋。
2. **中斷機制**：此腳本為無窮迴圈 (`while True`)，在終端機中請隨時準備使用 `Ctrl + C` 強制終止進程。

---

規格書已建立完畢。是否需要我直接將這兩個腳本整合成一個「帶有簡單圖形化介面 (GUI)」的小工具，讓你不用每次都在終端機改程式碼，只要點擊清單就能鎖定目標？